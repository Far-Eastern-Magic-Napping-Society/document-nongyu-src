import React,{useEffect,useState}from"react";import useDocusaurusContext from"@docusaurus/useDocusaurusContext";import{live2dConfig,getModel}from"./config";const Live2D=()=>{const{siteConfig:siteConfig}=useDocusaurusContext(),[isLoaded,setIsLoaded]=useState(!1);return useEffect((()=>{const timer=setTimeout((()=>{if(window.L2Dwidget)return void setIsLoaded(!0);const script=document.createElement("script");script.src="https://unpkg.com/live2d-widget@3.1.4/lib/L2Dwidget.min.js",script.async=!0,document.head.appendChild(script),script.onload=()=>{try{const model=getModel();window.L2Dwidget.init({model:{jsonPath:model.jsonPath},display:live2dConfig.display,mobile:live2dConfig.mobile,react:live2dConfig.react,dialog:{enable:live2dConfig.dialog.enable,script:live2dConfig.dialog.script,hitokoto:!1,hitokotoAPI:"",hitokotoMaxLength:20,hitokotoTime:6e4,hitokotoText:"一言",hitokotoWidth:250,hitokotoHeight:100,hitokotoX:0,hitokotoY:0,hitokotoFont:"12px Microsoft YaHei",hitokotoColor:"#191970",hitokotoBackground:"rgba(255, 255, 255, 0.8)",hitokotoBorder:"1px solid #ccc",hitokotoBorderRadius:"5px",hitokotoPadding:"10px",hitokotoBoxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",hitokotoZIndex:9999}}),setIsLoaded(!0)}catch(error){console.error("Live2D 初始化失败:",error)}},script.onerror=()=>{console.error("Live2D 脚本加载失败")}}),1e3);return()=>{if(clearTimeout(timer),window.L2Dwidget)try{window.L2Dwidget.destroy()}catch(error){console.error("Live2D 清理失败:",error)}}}),[]),null};export default Live2D;